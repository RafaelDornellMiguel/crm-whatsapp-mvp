{
  "query": "\n-- Criar tabela de departamentos\nCREATE TABLE IF NOT EXISTS `departamentos` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `tenantId` INT NOT NULL,\n  `nome` VARCHAR(100) NOT NULL,\n  `descricao` TEXT,\n  `cor` VARCHAR(7) DEFAULT '#3B82F6',\n  `ativo` BOOLEAN DEFAULT true NOT NULL,\n  `createdAt` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updatedAt` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  UNIQUE KEY `unique_tenant_nome` (`tenantId`, `nome`),\n  FOREIGN KEY (`tenantId`) REFERENCES `empresas`(`id`) ON DELETE CASCADE\n);\n\n-- Adicionar coluna departamento_id na tabela de usuários\nALTER TABLE `users` ADD COLUMN `departamentoId` INT AFTER `setor`;\nALTER TABLE `users` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de números WhatsApp\nALTER TABLE `numeros_whatsapp` ADD COLUMN `departamentoId` INT AFTER `vendedorId`;\nALTER TABLE `numeros_whatsapp` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de mensagens\nALTER TABLE `mensagens` ADD COLUMN `departamentoId` INT AFTER `tenantId`;\nALTER TABLE `mensagens` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de pedidos\nALTER TABLE `pedidos` ADD COLUMN `departamentoId` INT AFTER `tenantId`;\nALTER TABLE `pedidos` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de contatos\nALTER TABLE `contatos` ADD COLUMN `departamentoId` INT AFTER `tenantId`;\nALTER TABLE `contatos` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Criar índices para performance\nCREATE INDEX `idx_departamentos_tenant` ON `departamentos`(`tenantId`);\nCREATE INDEX `idx_users_departamento` ON `users`(`departamentoId`);\nCREATE INDEX `idx_numeros_whatsapp_departamento` ON `numeros_whatsapp`(`departamentoId`);\nCREATE INDEX `idx_mensagens_departamento` ON `mensagens`(`departamentoId`);\nCREATE INDEX `idx_pedidos_departamento` ON `pedidos`(`departamentoId`);\nCREATE INDEX `idx_contatos_departamento` ON `contatos`(`departamentoId`);\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 9B7modryQjtWire.0a3ca8b15657 --database SQThxAiNDBPw7XRLS5QJVG --execute \n-- Criar tabela de departamentos\nCREATE TABLE IF NOT EXISTS `departamentos` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `tenantId` INT NOT NULL,\n  `nome` VARCHAR(100) NOT NULL,\n  `descricao` TEXT,\n  `cor` VARCHAR(7) DEFAULT '#3B82F6',\n  `ativo` BOOLEAN DEFAULT true NOT NULL,\n  `createdAt` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updatedAt` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  UNIQUE KEY `unique_tenant_nome` (`tenantId`, `nome`),\n  FOREIGN KEY (`tenantId`) REFERENCES `empresas`(`id`) ON DELETE CASCADE\n);\n\n-- Adicionar coluna departamento_id na tabela de usuários\nALTER TABLE `users` ADD COLUMN `departamentoId` INT AFTER `setor`;\nALTER TABLE `users` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de números WhatsApp\nALTER TABLE `numeros_whatsapp` ADD COLUMN `departamentoId` INT AFTER `vendedorId`;\nALTER TABLE `numeros_whatsapp` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de mensagens\nALTER TABLE `mensagens` ADD COLUMN `departamentoId` INT AFTER `tenantId`;\nALTER TABLE `mensagens` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de pedidos\nALTER TABLE `pedidos` ADD COLUMN `departamentoId` INT AFTER `tenantId`;\nALTER TABLE `pedidos` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Adicionar coluna departamento_id na tabela de contatos\nALTER TABLE `contatos` ADD COLUMN `departamentoId` INT AFTER `tenantId`;\nALTER TABLE `contatos` ADD FOREIGN KEY (`departamentoId`) REFERENCES `departamentos`(`id`) ON DELETE SET NULL;\n\n-- Criar índices para performance\nCREATE INDEX `idx_departamentos_tenant` ON `departamentos`(`tenantId`);\nCREATE INDEX `idx_users_departamento` ON `users`(`departamentoId`);\nCREATE INDEX `idx_numeros_whatsapp_departamento` ON `numeros_whatsapp`(`departamentoId`);\nCREATE INDEX `idx_mensagens_departamento` ON `mensagens`(`departamentoId`);\nCREATE INDEX `idx_pedidos_departamento` ON `pedidos`(`departamentoId`);\nCREATE INDEX `idx_contatos_departamento` ON `contatos`(`departamentoId`);\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 9405
}